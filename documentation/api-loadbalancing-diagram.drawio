<mxfile host="65bd71144e">
    <diagram id="pulse-api-loadbalancing" name="API and Load Balancing">
        <mxGraphModel dx="1180" dy="933" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="title" value="ANGEL INTELLIGENCE - API ARCHITECTURE &amp;amp; LOAD BALANCING" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1;fontColor=#1a1a2e;" parent="1" vertex="1">
                    <mxGeometry x="230" y="20" width="820" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="clients-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f4f8;strokeColor=#0077b6;strokeWidth=2;dashed=1;" parent="1" vertex="1">
                    <mxGeometry x="250" y="80" width="300" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="clients-title" value="EXTERNAL CLIENTS" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#0077b6;" parent="1" vertex="1">
                    <mxGeometry x="260" y="85" width="150" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="client-web" value="Web Dashboard&#xa;(React/Vue)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4895ef;strokeColor=#023e8a;strokeWidth=2;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="270" y="110" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="client-dev" value="Dev/Testing&#xa;(Postman/curl)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6c757d;strokeColor=#495057;strokeWidth=2;fontSize=10;fontColor=#ffffff;" vertex="1" parent="1">
                    <mxGeometry x="410" y="110" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="internal-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6f7e6;strokeColor=#2d6a4f;strokeWidth=2;dashed=1;" vertex="1" parent="1">
                    <mxGeometry x="780" y="80" width="440" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="internal-title" value="INTERNAL WORKERS" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#2d6a4f;" vertex="1" parent="1">
                    <mxGeometry x="790" y="85" width="150" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="client-orin" value="Orin Workers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#40916c;strokeColor=#1b4332;strokeWidth=2;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="800" y="110" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="client-thor" value="Thor Workers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e85d04;strokeColor=#9d0208;strokeWidth=2;fontSize=10;fontColor=#ffffff;" vertex="1" parent="1">
                    <mxGeometry x="940" y="110" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="client-generic" value="Generic Workers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#118ab2;strokeColor=#073b4c;strokeWidth=2;fontSize=10;fontColor=#ffffff;" vertex="1" parent="1">
                    <mxGeometry x="1080" y="110" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="ingress-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3cd;strokeColor=#f77f00;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="40" y="200" width="720" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="ingress-title" value="KUBERNETES INGRESS (nginx-ingress / Traefik)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#f77f00;" parent="1" vertex="1">
                    <mxGeometry x="220" y="205" width="360" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="ingress-https" value="HTTPS :443&#xa;TLS Termination" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f77f00;strokeColor=#d62828;strokeWidth=2;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="60" y="235" width="100" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="ingress-routes" value="Path-Based Routing&#xa;/api/* → api-service&#xa;/health → health-check" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#f77f00;strokeWidth=2;fontSize=9;align=left;" parent="1" vertex="1">
                    <mxGeometry x="180" y="235" width="180" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="ingress-ratelimit" value="Rate Limiting&#xa;100 req/min per IP&#xa;1000 req/min per API key" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#f77f00;strokeWidth=2;fontSize=9;align=left;" parent="1" vertex="1">
                    <mxGeometry x="380" y="235" width="160" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="ingress-cors" value="CORS / Headers&#xa;Security Policies" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#f77f00;strokeWidth=2;fontSize=9;" parent="1" vertex="1">
                    <mxGeometry x="560" y="235" width="120" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="nodeport-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e6f7e6;strokeColor=#2d6a4f;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="780" y="200" width="580" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="nodeport-title" value="NODEPORT SERVICES (Internal Network)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#2d6a4f;" parent="1" vertex="1">
                    <mxGeometry x="900" y="205" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="nodeport-vllm" value="vLLM NodePort&#xa;:30800&#xa;All Nodes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9d4edd;strokeColor=#5a189a;strokeWidth=2;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="800" y="235" width="100" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="nodeport-transcription" value="Transcription&#xa;:30801&#xa;Thor Only" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#06d6a0;strokeColor=#028a63;strokeWidth=2;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="920" y="235" width="100" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="nodeport-redis" value="Redis&#xa;:30379&#xa;Gateway Only" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e63946;strokeColor=#9d0208;strokeWidth=2;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="1040" y="235" width="100" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="nodeport-mysql" value="MySQL&#xa;(External)&#xa;db-host:3306" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#2a9d8f;strokeColor=#1d6f64;strokeWidth=2;fontSize=10;fontColor=#ffffff;dashed=1;" vertex="1" parent="1">
                    <mxGeometry x="1160" y="235" width="100" height="50" as="geometry"/>
                </mxCell>
                <mxCell id="api-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f4f8;strokeColor=#0077b6;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="40" y="320" width="720" height="270" as="geometry"/>
                </mxCell>
                <mxCell id="api-title" value="FASTAPI APPLICATION (Gateway Node)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#0077b6;" parent="1" vertex="1">
                    <mxGeometry x="260" y="325" width="280" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="api-calls" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4895ef;strokeColor=#023e8a;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="60" y="360" width="370" height="210" as="geometry"/>
                </mxCell>
                <mxCell id="api-calls-title" value="RECORDINGS API" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="100" y="365" width="300" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="api-calls-endpoints" value="POST /recordings/submit&#xa;  → Submit audio for processing&#xa;  → Returns recording_id&#xa;&#xa;GET /recordings/{id}/status&#xa;  → Processing status&#xa;&#xa;GET /recordings/{id}/transcription&#xa;  → Transcription results&#xa;&#xa;GET /recordings/{id}/analysis&#xa;  → Analysis results" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="70" y="390" width="350" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="api-agents" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#118ab2;strokeColor=#073b4c;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="446" y="360" width="289" height="210" as="geometry"/>
                </mxCell>
                <mxCell id="api-agents-title" value="UTILITY API" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="506" y="365" width="169" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="api-agents-endpoints" value="POST /recordings/reprocess/{id}&#xa;  → Requeue for reprocessing&#xa;&#xa;GET /recordings/pending&#xa;  → List pending recordings&#xa;&#xa;GET /recordings/failed&#xa;  → List failed recordings&#xa;&#xa;POST /api/transcribe&#xa;  → Transcribe only (Dojo)&#xa;&#xa;GET /health&#xa;  → Health check" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="456" y="390" width="269" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-lb-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e6ff;strokeColor=#9d4edd;strokeWidth=3;" parent="1" vertex="1">
                    <mxGeometry x="780" y="320" width="580" height="340" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-lb-title" value="vLLM LOAD BALANCING (Thor Node)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#9d4edd;" parent="1" vertex="1">
                    <mxGeometry x="920" y="325" width="300" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="k8s-service" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9d4edd;strokeColor=#5a189a;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="800" y="360" width="540" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="k8s-service-title" value="Kubernetes Service: vllm-service" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="950" y="365" width="240" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="k8s-service-info" value="Type: ClusterIP + NodePort&#xa;ClusterIP: vllm-service:8000 (internal)&#xa;NodePort: &lt;any-node-ip&gt;:30800 (external)&#xa;Load Balancing: Round-Robin (iptables/IPVS)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="820" y="388" width="280" height="45" as="geometry"/>
                </mxCell>
                <mxCell id="k8s-service-selector" value="selector:&#xa;  app: vllm" style="text;html=1;strokeColor=none;fillColor=#5a189a;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="1120" y="388" width="100" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="endpoints-box" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#7b2cbf;strokeColor=#5a189a;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="800" y="460" width="540" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="endpoints-title" value="Endpoints (Auto-discovered by K8s)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="950" y="465" width="240" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="endpoint-1" value="10.244.1.10:8000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#5a189a;fontSize=10;fontColor=#333333;" parent="1" vertex="1">
                    <mxGeometry x="860" y="488" width="120" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="endpoint-2" value="10.244.1.11:8000" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#5a189a;fontSize=10;fontColor=#333333;" parent="1" vertex="1">
                    <mxGeometry x="1000" y="488" width="120" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="endpoint-arrow" value="↔" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=16;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="980" y="485" width="20" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5a189a;strokeColor=#3c096c;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="800" y="540" width="260" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-1-title" value="vLLM POD 1 (vllm-server-xxx-abc)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="850" y="545" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-1-model" value="Qwen2.5-72B-AWQ&#xa;~40GB Memory" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3c096c;fontSize=9;" parent="1" vertex="1">
                    <mxGeometry x="815" y="570" width="100" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-1-lora" value="LoRA: pulse-v1&#xa;Hot-loadable" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3c096c;fontSize=9;" parent="1" vertex="1">
                    <mxGeometry x="925" y="570" width="100" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-1-status" value="Ready: ✓  |  Requests: 45/min" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="830" y="610" width="180" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#5a189a;strokeColor=#3c096c;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="1080" y="540" width="260" height="100" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-2-title" value="vLLM POD 2 (vllm-server-xxx-def)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="1130" y="545" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-2-model" value="Qwen2.5-72B-AWQ&#xa;~40GB Memory" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3c096c;fontSize=9;" parent="1" vertex="1">
                    <mxGeometry x="1095" y="570" width="100" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-2-lora" value="LoRA: pulse-v1&#xa;Hot-loadable" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#3c096c;fontSize=9;" parent="1" vertex="1">
                    <mxGeometry x="1205" y="570" width="100" height="35" as="geometry"/>
                </mxCell>
                <mxCell id="vllm-pod-2-status" value="Ready: ✓  |  Requests: 42/min" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="1110" y="610" width="180" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="flow-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff8e6;strokeColor=#ffc107;strokeWidth=2;dashed=1;" parent="1" vertex="1">
                    <mxGeometry x="40" y="610" width="720" height="270" as="geometry"/>
                </mxCell>
                <mxCell id="flow-title" value="REQUEST FLOW EXAMPLES" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1;fontColor=#ffc107;" parent="1" vertex="1">
                    <mxGeometry x="50" y="615" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="flow1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ffc107;strokeWidth=1;" parent="1" vertex="1">
                    <mxGeometry x="50" y="640" width="700" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="flow1-title" value="1. Recording Submission:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#333333;" parent="1" vertex="1">
                    <mxGeometry x="60" y="643" width="140" height="15" as="geometry"/>
                </mxCell>
                <mxCell id="flow1-steps" value="Client → Ingress:443 → api-service:8080 → POST /recordings/submit → Redis Queue → Return recording_id" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" parent="1" vertex="1">
                    <mxGeometry x="60" y="658" width="680" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="flow2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ffc107;strokeWidth=1;" parent="1" vertex="1">
                    <mxGeometry x="50" y="685" width="700" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="flow2-title" value="2. Worker Processing:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#333333;" parent="1" vertex="1">
                    <mxGeometry x="60" y="688" width="130" height="15" as="geometry"/>
                </mxCell>
                <mxCell id="flow2-steps" value="Worker (Orin/Thor) → Redis:30379 dequeue → Transcription:30801 → vLLM:30800 (load-balanced) → MySQL (external)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" parent="1" vertex="1">
                    <mxGeometry x="60" y="703" width="680" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="flow3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ffc107;strokeWidth=1;" vertex="1" parent="1">
                    <mxGeometry x="50" y="730" width="700" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="flow3-title" value="3. Status Check:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
                    <mxGeometry x="60" y="733" width="100" height="15" as="geometry"/>
                </mxCell>
                <mxCell id="flow3-steps" value="Client → Ingress:443 → api-service:8080 → GET /recordings/{id}/status → MySQL query → Return status (pending/processing/completed/failed)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="60" y="748" width="680" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="flow4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ffc107;strokeWidth=1;" vertex="1" parent="1">
                    <mxGeometry x="50" y="775" width="700" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="flow4-title" value="4. Fetch Results:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
                    <mxGeometry x="60" y="778" width="100" height="15" as="geometry"/>
                </mxCell>
                <mxCell id="flow4-steps" value="Client → Ingress:443 → api-service:8080 → GET /recordings/{id}/analysis → MySQL query → Return analysis JSON" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="60" y="793" width="680" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="flow5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffffff;strokeColor=#ffc107;strokeWidth=1;" vertex="1" parent="1">
                    <mxGeometry x="50" y="820" width="700" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="flow5-title" value="5. Chat API:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;fontStyle=1;fontColor=#333333;" vertex="1" parent="1">
                    <mxGeometry x="60" y="823" width="80" height="15" as="geometry"/>
                </mxCell>
                <mxCell id="flow5-steps" value="Client → Ingress:443 → api-service:8080 → POST /chat → vLLM:30800 (streaming) → Return AI response" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
                    <mxGeometry x="60" y="838" width="680" height="18" as="geometry"/>
                </mxCell>
                <mxCell id="legend-container" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8f9fa;strokeColor=#6c757d;strokeWidth=2;dashed=1;" parent="1" vertex="1">
                    <mxGeometry x="780" y="680" width="580" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="legend-title" value="LOAD BALANCING METHODS" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#333333;" parent="1" vertex="1">
                    <mxGeometry x="790" y="685" width="200" height="20" as="geometry"/>
                </mxCell>
                <mxCell id="legend-rr" value="Round-Robin" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#9d4edd;strokeColor=#5a189a;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="800" y="710" width="80" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="legend-rr-desc" value="K8s default, requests distributed evenly" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" parent="1" vertex="1">
                    <mxGeometry x="890" y="710" width="200" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="legend-sticky" value="Session Affinity" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ef476f;strokeColor=#9d0208;fontSize=9;fontColor=#ffffff;" parent="1" vertex="1">
                    <mxGeometry x="1100" y="710" width="90" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="legend-sticky-desc" value="Optional: ClientIP for streaming" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" parent="1" vertex="1">
                    <mxGeometry x="1200" y="710" width="150" height="25" as="geometry"/>
                </mxCell>
                <mxCell id="arrow-client-ingress" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#f77f00;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="400" y="180" as="sourcePoint"/>
                        <mxPoint x="400" y="200" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ingress-api" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#0077b6;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="400" y="300" as="sourcePoint"/>
                        <mxPoint x="400" y="320" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-internal-nodeport" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#2d6a4f;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1000" y="180" as="sourcePoint"/>
                        <mxPoint x="1000" y="200" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-svc-ep" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#9d4edd;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1070" y="440" as="sourcePoint"/>
                        <mxPoint x="1070" y="460" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ep-pod1" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#9d4edd;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="920" y="520" as="sourcePoint"/>
                        <mxPoint x="920" y="540" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="arrow-ep-pod2" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#9d4edd;strokeWidth=2;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1210" y="520" as="sourcePoint"/>
                        <mxPoint x="1210" y="540" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>